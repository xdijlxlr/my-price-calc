<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†å“é€²è²¨è¨ˆç®—å·¥å…·</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media (max-width: 640px) {
            .table-responsive thead { display: none; }
            .table-responsive tr { display: block; margin-bottom: 1rem; border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 1rem; }
            .table-responsive td { display: flex; justify-content: space-between; align-items: center; border: none; padding: 0.5rem 0; }
            .table-responsive td::before { content: attr(data-label); font-weight: bold; color: #4a5568; }
        }
    </style>
</head>
<body class="bg-gray-50 p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ“¦ å•†å“æ¡è³¼è¨ˆç®—è¡¨</h1>
        
        <div class="bg-white shadow-md rounded-lg overflow-hidden">
            <table class="w-full text-left border-collapse table-responsive">
                <thead class="bg-gray-100 border-b">
                    <tr>
                        <th class="p-3 text-sm font-semibold text-gray-600">å•†å“åç¨±</th>
                        <th class="p-3 text-sm font-semibold text-gray-600">é€²è²¨åƒ¹ (JPY)</th>
                        <th class="p-3 text-sm font-semibold text-gray-600">æ¶ˆè²»ç¨… (10%)</th>
                        <th class="p-3 text-sm font-semibold text-gray-600">å°è¨ˆ (JPY)</th>
                        <th class="p-3 text-sm font-semibold text-gray-600">åŒ¯ç‡ (JPYâ†’TWD)</th>
                        <th class="p-3 text-sm font-semibold text-gray-600 text-blue-600">å°è¨ˆ (TWD)</th>
                    </tr>
                </thead>
                <tbody id="product-body">
                    <tr class="hover:bg-gray-50 border-b">
                        <td data-label="å•†å“åç¨±" class="p-3">
                            <input type="text" placeholder="è¼¸å…¥åç¨±" class="w-full border rounded px-2 py-1 outline-blue-500">
                        </td>
                        <td data-label="é€²è²¨åƒ¹ (JPY)" class="p-3">
                            <input type="number" value="0" oninput="calculate(this)" class="input-jpy w-full border rounded px-2 py-1">
                        </td>
                        <td data-label="æ¶ˆè²»ç¨… (10%)" class="p-3">
                            <span class="tax-jpy text-gray-500">0</span>
                        </td>
                        <td data-label="å°è¨ˆ (JPY)" class="p-3 font-medium">
                            <span class="subtotal-jpy">0</span>
                        </td>
                        <td data-label="åŒ¯ç‡" class="p-3">
                            <input type="number" value="0.22" step="0.001" oninput="calculate(this)" class="input-rate w-full border rounded px-2 py-1">
                        </td>
                        <td data-label="å°è¨ˆ (TWD)" class="p-3 font-bold text-blue-600">
                            <span class="subtotal-twd">0</span>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <div class="p-4 bg-gray-50 border-t flex justify-between">
                <button onclick="addRow()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded text-sm transition">ï¼‹ æ–°å¢å•†å“</button>
                <div class="text-right">
                    <p class="text-sm text-gray-600">ç¸½è¨ˆ (TWD): <span id="grand-total" class="text-xl font-bold text-blue-700 ml-2">0</span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function calculate(element) {
            const row = element.closest('tr');
            const jpyPrice = parseFloat(row.querySelector('.input-jpy').value) || 0;
            const rate = parseFloat(row.querySelector('.input-rate').value) || 0;

            // å…¬å¼è¨ˆç®—
            const tax = Math.round(jpyPrice * 0.1);
            const subtotalJPY = jpyPrice + tax;
            const subtotalTWD = Math.round(subtotalJPY * rate);

            // æ›´æ–°é¡¯ç¤º
            row.querySelector('.tax-jpy').innerText = tax.toLocaleString();
            row.querySelector('.subtotal-jpy').innerText = subtotalJPY.toLocaleString();
            row.querySelector('.subtotal-twd').innerText = subtotalTWD.toLocaleString();

            updateGrandTotal();
        }

        function updateGrandTotal() {
            let total = 0;
            document.querySelectorAll('.subtotal-twd').forEach(span => {
                total += parseInt(span.innerText.replace(/,/g, '')) || 0;
            });
            document.getElementById('grand-total').innerText = total.toLocaleString();
        }

        function addRow() {
            const tbody = document.getElementById('product-body');
            const newRow = tbody.children[0].cloneNode(true);
            newRow.querySelectorAll('input').forEach(input => {
                if(input.type === 'number') input.value = input.className.includes('input-rate') ? '0.22' : '0';
                else input.value = '';
            });
            newRow.querySelectorAll('span').forEach(span => span.innerText = '0');
            tbody.appendChild(newRow);
        }
    </script>
</body>
</html>